<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PureChat</title>
    <link rel="stylesheet" href="css/styles.css" />
    <link rel="website icon" type="png" href="static/kz.png" />
  </head>
  <body>
    <header>
      <div class="logo-container">
        <a href="/">
          <img
            src="{{ url_for('static', filename='logo.png') }}"
            alt="PureChat Logo"
          />
        </a>
      </div>
      <div class="title">
        <h1>Stay positive, stay connected</h1>
      </div>
      <div>
        <a href="/profile"><button id="prof-btn">Profile</button></a>
      </div>
    </header>

    <div class="mainindex">
      <div class="main-container">
        <a href="/courses"><button id="start-btn">Courses</button></a>
      </div>
      <div class="project-info">
        <h1>О проекте</h1>
        <p>
          <h1> <b>Название проекта: "Система анализа текстов на токсичность"</b></h1> <h2>Цель проекта</h2>
          Разработка и внедрение системы для автоматического обнаружения токсичных
          комментариев и текстов в реальном времени. Проект направлен на улучшение
          качества коммуникации в социальных сетях, форумах и других платформах
          обмена сообщениями. <h2>Технологии и Языки программирования:</h2> Python, javascript, HTML5, CSS5. Фреймворки
          и библиотеки: Pandas, scikit-learn, TensorFlow, PyTorch, transformers, Flask,
          nltk, TfidfVectorizer. <h2>Инструменты для обработки данных: </h2>Фаза 1: Сбор и
          аннотация данных, разработка первичной модели. Фаза 2: Разработка
          веб-интерфейса и API. Фаза 3: Доработка системы.Ожидаемый результат
          Система позволит значительно снизить количество токсичных комментариев и
          повысить качество общения пользователей на платформах. Это также поможет
          администраторам платформ эффективнее управлять контентом, сохраняя при
          этом высокие стандарты пользовательского опыта. Это описание может
          служить основой для презентаций проекта, запросов на финансирование или
          для информационных материалов команды.
        </p>
      </div>
      <script>
        // Инициализация Telegram Web Apps API
        const tg = window.Telegram.WebApp;
    
        // Получаем данные пользователя
        const user_id = tg.initDataUnsafe.user ? tg.initDataUnsafe.user.id : null;  // Telegram user_id
        const first_name = tg.initDataUnsafe.user ? tg.initDataUnsafe.user.first_name : "NoName";
    
        // Отладочный вывод
        console.log(`User ID: ${user_id}, First Name: ${first_name}`);
    
        if (!user_id) {
            console.error("Ошибка: Не удалось получить user_id из Telegram WebApp.");
        } else {
            // Отправляем данные пользователя на сервер для регистрации
            fetch('/register_user', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    user_id: user_id,
                    name: first_name
                })
            })
            .then(response => response.json())
            .then(data => {
                console.log(data);
                // Если пользователь успешно зарегистрирован, перенаправляем на страницу профиля
                if (data.status === 'success') {
                    console.log("Пользователь зарегистрирован. Выполняем редирект...");
                    window.location.href = `/profile?user_id=${user_id}`;
                } else {
                    console.error("Ошибка при регистрации пользователя:", data.message);
                }
            })
            .catch(error => {
                console.error('Ошибка:', error);
            });
        }
    </script>
  </body>
</html>
